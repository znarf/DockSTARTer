services:
  telegraf:
    container_name: telegraf
    environment:
      - HOST_ETC=/host/etc
      - HOST_MOUNT_PREFIX=/host
      - HOST_PROC=/host/proc
      - HOST_SYS=/host/sys
      - TZ=${TZ}
    labels:
      com.dockstarter.appinfo.description: "Agent for collecting metrics and writing them to InfluxDB"
      com.dockstarter.appinfo.nicename: "Telegraf"
      com.dockstarter.appvars.telegraf_backup_config: "true"
      com.dockstarter.appvars.telegraf_enabled: "false"
      com.dockstarter.appvars.telegraf_network_mode: ""
      com.dockstarter.appvars.telegraf_port_8092: "8092"
      com.dockstarter.appvars.telegraf_port_8094: "8094"
      com.dockstarter.appvars.telegraf_port_8125: "8125"
    logging:
      driver: json-file
      options:
        max-file: ${DOCKERLOGGING_MAXFILE}
        max-size: ${DOCKERLOGGING_MAXSIZE}
    restart: unless-stopped
    volumes:
      - /:/host:ro
      - /etc:/host/etc:ro
      - /etc/localtime:/etc/localtime:ro
      - /proc:/host/proc:ro
      - /sys:/host/sys:ro
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - /var/run/utmp:/var/run/utmp:ro
      - ${DOCKERCONFDIR}/telegraf:/var/lib/telegraf
      - ${DOCKERSHAREDDIR}:/shared
